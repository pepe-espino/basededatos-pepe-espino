CREATE TABLE EQUIPOS
(
	NOMBRE VARCHAR2(15),
	CONSTRAINT PK_EQUIPOS PRIMARY KEY(NOMBRE)
);

CREATE TABLE CICLISTAS
(
	NOMBRE VARCHAR2(40),
	NACIONALIDAD VARCHAR2(25),
	FECHA_NACIMIENTO DATE,
	EQUIPO VARCHAR2(15),
	CONSTRAINT PK_CICLISTAS PRIMARY KEY(NOMBRE),
	CONSTRAINT FK_CICLISTAS FOREIGN KEY(EQUIPO) REFERENCES EQUIPOS(NOMBRE)
);

CREATE TABLE ETAPAS
(
	CODETAPA VARCHAR2(15),
	DISTANCIA NUMBER(5),
	ANO_ETAPA DATE,
	GANADOR VARCHAR2(25),
	CONSTRAINT PK_ETAPAS PRIMARY KEY(CODETAPA),
	CONSTRAINT FK_ETAPAS FOREIGN KEY(GANADOR) REFERENCES CICLISTAS(NOMBRE)
);


INSERT INTO EQUIPOS
VALUES ('Movistar');

INSERT INTO EQUIPOS
VALUES ('Jumbo');

INSERT INTO EQUIPOS
VALUES ('Bora');

INSERT INTO EQUIPOS
VALUES ('UAE Team');


INSERT INTO CICLISTAS
VALUES ('Alejandro Valverde','Español', TO_DATE('25-04-1980','DD-MM-YYYY'),'Movistar');

INSERT INTO CICLISTAS
VALUES ('Alejandra Valverde','Español', TO_DATE('25-04-1980','DD-MM-YYYY'),'Movistar');

INSERT INTO CICLISTAS
VALUES ('Mathias Norsgaard','Danés', TO_DATE('01-05-1997','DD-MM-YYYY'),'Movistar');

INSERT INTO CICLISTAS
VALUES ('Primox Roglic','Esloveno', TO_DATE('01-01-1997','DD-MM-YYYY'),'Jumbo');

INSERT INTO CICLISTAS
VALUES ('R. Gesink','Holandes', TO_DATE('01-05-2003','DD-MM-YYYY'),'Jumbo');

INSERT INTO CICLISTAS
VALUES ('S. Bennett','Irlandés', TO_DATE('03-08-2000','DD-MM-YYYY'),'Bora');

INSERT INTO CICLISTAS
VALUES ('M. Soler','Español', TO_DATE('09-11-2003','DD-MM-YYYY'),'UAE Team');

SELECT * FROM CICLISTAS;

INSERT INTO ETAPAS
VALUES ('E1_2022',23,TO_DATE('2022','YYYY'),'R. Gesink');

INSERT INTO ETAPAS
VALUES ('E2_2022',175,TO_DATE('2022','YYYY'),'Primox Roglic');

INSERT INTO ETAPAS
VALUES ('E3_2022',193,TO_DATE('2022','YYYY'),'S. Bennett');

INSERT INTO ETAPAS
VALUES ('E1_2021',154,TO_DATE('2021','YYYY'),'S. Bennett');
/*
INSERT INTO ETAPAS
VALUES ('E1_2021','','','');
*/
INSERT INTO ETAPAS
VALUES ('E1_2020',40,TO_DATE('2022','YYYY'),'Alejandro Valverde');

SELECT * FROM ETAPAS;

UPDATE ETAPAS 
SET CODETAPA LIKE 'CRONOMETRO'+ANO_ETAPA; 
WHERE DISTANCIA < 100;

CREATE TABLE CICLISTAS_ESPANOLES
(
	NOMBRE VARCHAR2(40),
	EQUIPO VARCHAR2(15),
	CONSTRAINT PK_CICLISTAS_ESPANOLES PRIMARY KEY(NOMBRE),
	CONSTRAINT FK1_CICLISTAS_ESPANOLES FOREIGN KEY(EQUIPO) REFERENCES EQUIPOS(NOMBRE),
	CONSTRAINT FK2_CICLISTAS_ESPANOLES FOREIGN KEY(NOMBRE) REFERENCES CICLISTAS(NOMBRE)
);


INSERT INTO CICLISTAS_ESPANOLES
SELECT
	CICLISTAS.NOMBRE,
	CICLISTAS.EQUIPO,
FROM 
	CICLISTAS c 
JOIN
	EQUIPOS e 
ON
	CICLISTAS.EQUIPO 
WHERE 
	CICLISTAS.NACIONALIDAD; 
















